(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{7572:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/register",function(){return r(6278)}])},6278:function(e,s,r){"use strict";r.r(s);var t=r(5893),a=r(7294),n=r(7311),o=r(9332),i=r(7498);s.default=function(){let{state:e,dispatch:s}=(0,i.j)(),r=(0,o.useRouter)(),[l,c]=(0,a.useState)({username:"",passwordConf:"",firstName:"",lastName:"",email:""}),u=(e,s)=>{c({...l,[e]:s})};async function d(t){var a;t.preventDefault(),n.Z.register(l),s({currentUserToken:e.currentUserToken,currentUser:null===(a=e.currentUser)||void 0===a?void 0:a.user_id}),r.push("/")}return(0,t.jsx)("div",{className:"w-screen h-screen",children:(0,t.jsx)("div",{className:"flex",children:(0,t.jsxs)("form",{className:"mx-auto border-2 bg-mtgray",onSubmit:d,children:[(0,t.jsxs)("div",{className:"flex justify-between m-2 items-center space-x-2",children:[(0,t.jsx)("label",{htmlFor:"username",children:"Username:"}),(0,t.jsx)("input",{className:"border",type:"text",id:"username",required:!0,onChange:e=>u("username",e.target.value)})]}),(0,t.jsxs)("div",{className:"flex justify-between m-2 items-center space-x-2",children:[(0,t.jsx)("label",{htmlFor:"firstName",children:"First Name:"}),(0,t.jsx)("input",{className:"border",type:"text",id:"firstName",required:!0,onChange:e=>u("firstName",e.target.value)})]}),(0,t.jsxs)("div",{className:"flex justify-between m-2 items-center space-x-2",children:[(0,t.jsx)("label",{htmlFor:"lastName",children:"Last Name:"}),(0,t.jsx)("input",{className:"border",type:"text",id:"lastName",required:!0,onChange:e=>u("lastName",e.target.value)})]}),(0,t.jsxs)("div",{className:"flex justify-between m-2 items-center space-x-2",children:[(0,t.jsx)("label",{htmlFor:"email",children:"Email:"}),(0,t.jsx)("input",{className:"border",type:"text",id:"email",required:!0,onChange:e=>u("email",e.target.value)})]}),(0,t.jsxs)("div",{className:"flex justify-between m-2 items-center space-x-2",children:[(0,t.jsx)("label",{htmlFor:"password",children:"Password:"}),(0,t.jsx)("input",{className:"border",type:"text",id:"password",required:!0,onChange:e=>u("password",e.target.value)})]}),(0,t.jsxs)("div",{className:"flex justify-between m-2 items-center space-x-2",children:[(0,t.jsx)("label",{htmlFor:"passwordConf",children:"Confirm Password:"}),(0,t.jsx)("input",{className:"border",type:"text",id:"passwordConf",required:!0,onChange:e=>u("passwordConf",e.target.value)})]}),(0,t.jsx)("div",{className:"flex",children:(0,t.jsx)("input",{type:"submit",value:"Register!",className:"bg-mtpurple text-white py-2 px-4 rounded-lg mx-auto my-2 font-bold disabled:opacity-60",disabled:!l.password||!(l.password.length>=8)||l.password!==l.passwordConf||!l.firstName||!l.lastName||!l.email})})]})})})}},3496:function(e,s,r){"use strict";function t(){let e=JSON.parse(localStorage.getItem("user"));return e&&e.access?{Authorization:"Bearer "+e.access}:{}}r.d(s,{Z:function(){return t}})},7311:function(e,s,r){"use strict";r.d(s,{Z:function(){return c}});let t="http://127.0.0.1:8000/",a="token/refresh/";var n=r(6154),o=r(3496);let i=n.Z.create({baseURL:t});i.interceptors.response.use(e=>e,e=>{let s=e.config;if(401===e.response.status&&s.url===t+a)return window.location.href="/login/",Promise.reject(e);if("token_not_valid"===e.response.data.code&&401===e.response.status&&"Unauthorized"===e.response.statusText){let e=localStorage.getItem("user");if(e){let r=JSON.parse(atob(e.refresh.split(".")[1])),t=Math.ceil(Date.now()/1e3);if(console.log(r.exp),r.exp>t)return i.post(a,{refresh:e.refresh}).then(e=>(localStorage.setItem("user",e.data),i.defaults.headers.Authorization="Bearer "+e.data.access,s.headers.Authorization="Bearer "+e.data.access,i(s))).catch(e=>{console.log(e)});console.log("Refresh token is expired",r.exp,t),window.location.href="/login/"}else console.log("Refresh token not available."),window.location.href="/login/"}return Promise.reject(e)});var l=e=>i({...e,headers:(0,o.Z)()}).then(e=>(console.debug("Request Successful!",e),e)).catch(e=>(console.error("Request Failed:",e.config),e.response?(console.error("Status:",e.response.status),console.error("Data:",e.response.data),console.error("Headers:",e.response.headers)):console.error("Error Message:",e.message),Promise.reject(e.response||e.message)));r(1876);var c=new class{async login(e,s,r){try{let t=await l({url:"user/login/",method:"POST",data:{email:e,password:s,username:r}});if(t.data.access)return this.setToken(t)}catch(e){return e.response}}logout(){localStorage.removeItem("user")}async register(e){let{username:s,email:r,password:t,firstName:a,lastName:n,image:o}=e;try{await l({url:"user/signup/",method:"POST",data:{username:s,email:r,password:t,first_name:a,last_name:n,image:o}}),await this.login(r,t,s)}catch(e){return e.response}}setToken(e){return localStorage.setItem("user",JSON.stringify(e.data)),e.data}async refreshToken(){try{let e=JSON.parse(localStorage.getItem("user"));if(e.refresh){let s=await l({url:a,method:"POST",data:{refresh:e.refresh}});return s.data}}catch(e){return e.response}}constructor(){this.login=this.login.bind(this)}}}},function(e){e.O(0,[316,774,888,179],function(){return e(e.s=7572)}),_N_E=e.O()}]);